<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="./css/style.css"/>
</head>


<script src="./scripts/questions.js"></script>
<script>

    let questionNum = 0;
    let timeoutHandle;
    let score = 0;
    const totalQuestions = JsonQuestions.length;

    function fShowThisResult() {
        let user = document.getElementById("divUser").value;
        alert(user + ", your score is: " + score);
        let newScore = {"student": user, "score": "" + score};
        let JsonScores = JSON.parse(localStorage.getItem("JsonScores"));
        JsonScores.push(newScore);
        localStorage.setItem("JsonScores",JSON.stringify(JsonScores));
    }

    function fShowScores() {
        let sScoreContent = "";
        let JsonScores = JSON.parse(localStorage.getItem("JsonScores"));
        for (let i = 0; i < JsonScores.length; i++) {
            sScoreContent += JsonScores[i].student + " - " + JsonScores[i].score + "</<br>";
        }
        alert(sScoreContent);
        let modal = $('#exampleModal');
        modal.find('.modal-body').text('New message to ');
        // modal.find('.modal-body input')..val(sScoreContent);

    }

    function getNextQuestion() {
        if ((totalQuestions === (questionNum))) {
            clearInterval(timeoutHandle);
            fShowThisResult();
            fNewGame();
        }

        document.getElementById("divQuestion").innerHTML = JsonQuestions[questionNum].question;
        document.getElementById("divOptionA").innerHTML = JsonQuestions[questionNum].optionA;
        document.getElementById("divOptionB").innerHTML = JsonQuestions[questionNum].optionB;
        document.getElementById("divOptionC").innerHTML = JsonQuestions[questionNum].optionC;
        document.getElementById("divOptionD").innerHTML = JsonQuestions[questionNum].optionD;
        document.getElementById("divAnswer").innerHTML = "";


    }

    function fNewGame() {
        document.getElementById("divQuestion").style.display = "none";
        document.getElementById("divOptionA").style.display = "none";
        document.getElementById("divOptionB").style.display = "none";
        document.getElementById("divOptionC").style.display = "none";
        document.getElementById("divOptionD").style.display = "none";
        document.getElementById("divText").style.display = "inline-block";
        document.getElementById("btnBegin").style.display = "inline-block";
        document.getElementById("divTimer").innerHTML = "00:00";
        document.getElementById("divScore").innerHTML = "0";
        document.getElementById("divUser").value = "";

        score = 0;


        questionNum = 0;


    }

    function fBegin() {

        if (localStorage.getItem("JsonScores") == null) {
            localStorage.setItem("JsonScores", "[]");
        }
        document.getElementById("divQuestion").style.display = "block";
        document.getElementById("divOptionA").style.display = "block";
        document.getElementById("divOptionB").style.display = "block";
        document.getElementById("divOptionC").style.display = "block";
        document.getElementById("divOptionD").style.display = "block";
        document.getElementById("divText").style.display = "none";
        document.getElementById("btnBegin").style.display = "none";

        countdown(1);
        getNextQuestion();
    }

    function fAnswerSelected(answerSelected) {
        if ("DIV" + JsonQuestions[questionNum].answer.toString().toUpperCase() === answerSelected.id.toString().toUpperCase()) {
            document.getElementById("divAnswer").innerHTML = "Right";
            questionNum++;
            score++;
            document.getElementById("divScore").innerHTML = score;
            setTimeout(getNextQuestion, 1000);
        } else {
            document.getElementById("divAnswer").innerHTML = "Wrong";
            questionNum++;
            setTimeout(getNextQuestion, 1000);
        }


    }

</script>
<body style="background-color: lightgray">

<table class="game" border="1" width="100%">
    <tr height="90px">
        <td width="33%"><a href="" onclick="fShowScores()">Show Scores</a>
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                Show Scores
            </button>
            <div>Score:
                <div id="divScore">0</div>
            </div>
        </td>
        <td width="33%"></td>
        <td width="33%">
            <div id="divTimer">00:00</div>
        </td>
    </tr>
    <tr>
        <td></td>
        <td>
            <div id="divQuestion"></div>
            <div id="divOptionA" class="Option" onclick="fAnswerSelected(this);"></div>
            <div id="divOptionB" class="Option" onclick="fAnswerSelected(this);"></div>
            <div id="divOptionC" class="Option" onclick="fAnswerSelected(this);"></div>
            <div id="divOptionD" class="Option" onclick="fAnswerSelected(this);"></div>
            <div id="divText">User: <input id="divUser" class="User"></div>
            <button id="btnBegin" onclick="fBegin()">Begin tests</button>
            <div id="divAnswer" class="Answer"></div>
        </td>
        <td></td>
    </tr>
</table>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

</body>
<script>window.onload = fNewGame();
</script>

<script src="./scripts/timer.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</html>

